!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.app={})}(this,function(e){"use strict";function t(e,t){for(var n,o=[],r=[],i=arguments.length;i-- >2;)r.push(arguments[i]);for(;r.length;)if(Array.isArray(n=r.pop()))for(i=n.length;i--;)r.push(n[i]);else null==n||!0===n||!1===n||o.push(n);return"string"==typeof e?{name:e,props:t||{},children:o}:e(t||{},o)}function n(e,t){var o,r="",i=void 0===e?"undefined":s(e);if(e&&"string"===i||"number"===i)return e;if(t=t||" ",Array.isArray(e)&&e.length)for(var u=0,l=e.length;u<l;u++)(o=n(e[u],t))&&(r+=(r&&t)+o);else for(var u in e)e.hasOwnProperty(u)&&(o=e[u])&&(r+=(r&&t)+u+("object"===(void 0===o?"undefined":s(o))?n(o,t+u):""));return r}var o={All:0,Active:1,Completed:2},r=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},i=function(e,t){var n=arguments.length<=2?void 0:arguments[2];return e.map(function(e){return t===e.id?Object.assign({},e,n):e})},u={fetch:function(){return JSON.parse(localStorage.getItem("todos-hyperapp")||"[]")},save:function(e){return localStorage.setItem("todos-hyperapp",JSON.stringify(e))}},l={input:function(e){var t=e.value;return function(e){return{input:t}}},add:function(){return function(e){var t=e.todos.concat({id:r(),done:!1,editing:!1,value:e.input});return u.save(t),{input:"",todos:t}}},editUpdate:function(e){var t=e.uuid,n=e.value;return function(e,o){var r=i(e.todos,t,{editing:!1,value:n});return u.save(r),{todos:r}}},editEnter:function(e){var t=e.uuid,n=e.e;return function(e,o){o.editEnterDbClick(t),o.editEnterFocus(n)}},editEnterDbClick:function(e){return function(t,n){var o=i(t.todos,e,{editing:!0});return u.save(o),{todos:o}}},editEnterFocus:function(e){return function(t,n){e.target.parentNode.parentNode.querySelector(".edit").focus()}},remove:function(e){var t=e.uuid;return function(e,n){var o=e.todos.filter(function(e){return t!==e.id});return u.save(o),{todos:o}}},toggle:function(e){var t=e.uuid;return function(e,n){var o=e.todos.map(function(e){return t===e.id?Object.assign({},e,{done:!e.done}):e});return u.save(o),{todos:o}}},toggleAll:function(e){return function(t,n){var o=e.target.previousSibling.checked;o=!o;var r=t.todos.map(function(e){return e.done=o,e});return u.save(r),{todos:r}}},filter:function(e){var t=e.value;return function(e,n){return{filter:t}}},clearCompleted:function(){return function(e){var t=e.todos.filter(function(e){return!e.done});return u.save(t),{todos:t}}}},c={input:"",placeholder:"What needs to be done?",todos:[],filter:o.All},a=function(){return t("header",{className:"header"},t("h1",null,"todos"))},d=function(){return t("footer",{className:"info"},t("p",null,"Double-click to edit a todo"),t("p",null,"Written by ",t("a",{href:"http://dangthanh.org"},"Dang Van Thanh")),t("p",null,"Part of ",t("a",{href:"http://todomvc.com"},"TodoMVC")))},f=function(e){return t("div",null,t("input",{type:"text",class:"new-todo",onkeyup:function(t){return 13===t.keyCode&&""!==t.target.value?e.actions.add():null},oninput:function(t){return e.actions.input({value:t.target.value})},value:e.state.input,placeholder:e.state.placeholder,autofocus:!0}))},s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p=function(e){return t("li",{class:n(["todo",{completed:e.todo.done,editing:e.todo.editing}]),key:e.todo.id},t("div",{className:"view"},t("input",{type:"checkbox",class:"toggle",checked:!!e.todo.done,onclick:function(t){return e.actions.toggle({uuid:e.todo.id})}}),t("label",{ondblclick:function(t){return e.actions.editEnter({uuid:e.todo.id,e:t})}},e.todo.value),t("button",{class:"destroy",onclick:function(t){return e.actions.remove({uuid:e.todo.id})}})),t("input",{type:"text",class:"edit",onkeyup:function(t){return 13===t.keyCode?e.actions.editUpdate({uuid:e.todo.id,value:t.target.value}):null},onblur:function(t){return e.actions.editUpdate({uuid:e.todo.id,value:t.target.value})},value:e.todo.value}))},v=function(e){return t("ul",{class:"todo-list"},e.todos.filter(function(t){return e.filter===o.Completed?t.done:e.filter===o.Active?!t.done:e.filter===o.All}).map(function(n){return t(p,{todo:n,actions:e.actions})}))},h=function(e){return t("button",{className:"clear-completed",onclick:e.clearCompleted},"Clear completed")},m=function(e){return t("footer",{className:"footer"},t("span",{className:"todo-count"},e.state.todos.filter(function(e){return!e.done}).length," item left"),t("ul",{className:"filters"},Object.keys(o).map(function(n){return t("li",null,t("a",{href:"#",class:e.state.filter===o[n]?"selected":"",onclick:function(){return e.actions.filter({value:o[n]})}},n))})),e.state.todos.filter(function(e){return e.done}).length>0?t(h,{clearCompleted:e.actions.clearCompleted}):"")},g=function(e){return t("div",null,t("input",{type:"checkbox",className:"toggle-all",id:"toggle-all"}),t("label",{htmlFor:"toggle-all",onclick:function(t){return e.toggleAll(t)}},"Mark all as complete"))};c.todos=u.fetch(),c.todos=c.todos.map(function(e){return e.editing=!1,e});var y=function(e,t,n,o){function r(e,t){return e&&{name:e.nodeName.toLowerCase(),props:{},children:t.call(e.childNodes,function(e){return 3===e.nodeType?e.nodeValue:r(e,t)})}}function i(r){for(y=!y,r=n(e,t),o&&!y&&(b=g(o,b,k,k=r));r=x.pop();)r()}function u(){y||(y=!y,setTimeout(i))}function l(e,t){var n={};for(var o in e)n[o]=e[o];for(var o in t)n[o]=t[o];return n}function c(e,t,n,o){return e.length?(o[e[0]]=1<e.length?c(e.slice(1),t,n[e[0]],{}):t,l(n,o)):t}function a(e,t){for(var n=0;n<e.length;n++)t=t[e[n]];return t}function d(t,n,o){for(var r in o)"function"==typeof o[r]?function(r,i){o[r]=function(r){return n=a(t,e),"function"==typeof(r=i(r))&&(r=r(n,o)),r&&r!==n&&!r.then&&u(e=c(t,l(n,r),e,{})),r}}(r,o[r]):d(t.concat(r),n[r]=n[r]||{},o[r]=l(o[r]))}function f(e){return e&&e.props?e.props.key:null}function s(e,t,n,o){if("key"===t);else if("style"===t)for(var r in l(o,n))e[t][r]=null==n||null==n[r]?"":n[r];else{try{e[t]=null==n?"":n}catch(e){}"function"!=typeof n&&(null==n||!1===n?e.removeAttribute(t):e.setAttribute(t,n))}}function p(e,t){var n="string"==typeof e||"number"==typeof e?document.createTextNode(e):(t=t||"svg"===e.name)?document.createElementNS("http://www.w3.org/2000/svg",e.name):document.createElement(e.name);if(e.props){e.props.oncreate&&x.push(function(){e.props.oncreate(n)});for(var o=0;o<e.children.length;o++)n.appendChild(p(e.children[o],t));for(var r in e.props)s(n,r,e.props[r])}return n}function v(e,t,n){for(var o in l(t,n))n[o]!==("value"===o||"checked"===o?e[o]:t[o])&&s(e,o,n[o],t[o]);n.onupdate&&x.push(function(){n.onupdate(e,t)})}function h(e,t,n){if(n=t.props){for(var o=0;o<t.children.length;o++)h(e.childNodes[o],t.children[o]);n.ondestroy&&n.ondestroy(e)}return e}function m(e,t,n,o){function r(){e.removeChild(h(t,n))}n.props&&(o=n.props.onremove)?o(t,r):r()}function g(e,t,n,o,r,i){if(o===n);else if(null==n)t=e.insertBefore(p(o,r),t);else if(o.name&&o.name===n.name){v(t,n.props,o.props);for(var u=[],l={},c={},a=0;a<n.children.length;a++)u[a]=t.childNodes[a],null!=(y=f(s=n.children[a]))&&(l[y]=[u[a],s]);for(var a=0,d=0;d<o.children.length;){var s=n.children[a],h=o.children[d],y=f(s),x=f(h);if(c[y])a++;else if(null==x)null==y&&(g(t,u[a],s,h,r),d++),a++;else{var b=l[x]||[];y===x?(g(t,b[0],b[1],h,r),a++):b[0]?g(t,t.insertBefore(b[0],u[a]),b[1],h,r):g(t,u[a],null,h,r),d++,c[x]=h}}for(;a<n.children.length;)null==f(s=n.children[a])&&m(t,u[a],s),a++;for(var a in l)c[l[a][1].props.key]||m(t,l[a][0],l[a][1])}else o.name===n.name?t.nodeValue=o:(t=e.insertBefore(p(o,r),i=t),m(e,i,n));return t}var y,x=[],b=o&&o.children[0],k=r(b,[].map);return u(d([],e=l(e),t=l(t))),t}(c,l,function(e,n){return t("div",{class:"container"},t("section",{class:"todoapp"},t(a,null),t(f,{state:e,actions:n}),t("section",{className:"main"},e.todos.filter(function(e){return!e.done}).length>0?t(g,{toggleAll:n.toggleAll}):"",t(v,{todos:e.todos,actions:n,filter:e.filter})),t(m,{state:e,actions:n})),t(d,null))},document.getElementById("app"));e.main=y,Object.defineProperty(e,"__esModule",{value:!0})});
